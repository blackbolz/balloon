<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Balloon</title>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Pacifico&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #E0F6FF 50%, #87CEFA 100%);
            min-height: 100vh;
            overflow: hidden;
            position: relative;
            user-select: none;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            z-index: 100;
            position: relative;
        }

        /* Make header clickthrough in gun mode */
        body.gun-mode .header {
            pointer-events: none;
        }

        .title {
            font-family: 'Fredoka One', cursive;
            font-size: 4.5rem;
            font-weight: normal;
            background: linear-gradient(45deg, #FF6B6B, #FFD93D, #6BCF7F, #4ECDC4, #45B7D1, #96CEB4, #FECA57);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbow-shift 3s ease-in-out infinite;
            margin-bottom: 10px;
            letter-spacing: 12px;
            text-shadow: 
                2px 2px 0px rgba(255, 255, 255, 0.8),
                4px 4px 0px rgba(255, 182, 193, 0.6),
                6px 6px 0px rgba(255, 182, 193, 0.4),
                8px 8px 20px rgba(0, 0, 0, 0.3);
            transform: perspective(500px) rotateX(15deg);
            filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.2));
            transition: text-shadow 2s ease-in-out, filter 2s ease-in-out;
        }

        /* Night mode title adjustments */
        body.night .title, body.late-night .title {
            text-shadow: 
                2px 2px 0px rgba(255, 255, 255, 0.3),
                4px 4px 0px rgba(255, 182, 193, 0.2),
                6px 6px 0px rgba(255, 182, 193, 0.1),
                8px 8px 20px rgba(255, 255, 255, 0.1);
            filter: drop-shadow(0 10px 20px rgba(255, 255, 255, 0.1));
        }

        @keyframes rainbow-shift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        .subtitle {
            font-family: 'Pacifico', cursive;
            font-size: 1.8rem;
            background: linear-gradient(45deg, #FF69B4, #FFB347, #98FB98, #87CEEB);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: normal;
            font-style: normal;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin-top: 5px;
            transform: rotate(-2deg);
        }

        .main-icon {
            width: 400px;
            height: 400px;
            background-image: url('images/icon.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin: 30px auto;
            filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
            animation: gentle-float 4s ease-in-out infinite;
        }

        .main-icon:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 15px 40px rgba(0, 0, 0, 0.4));
        }

        @keyframes gentle-float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        /* Make main icon clickthrough in gun mode */
        body.gun-mode .main-icon {
            pointer-events: none;
        }

        .controls {
            position: fixed;
            left: 30px;
            top: calc(50% + 190px);
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 1000;
        }

        /* Make controls clickthrough in gun mode except for the buttons themselves */
        body.gun-mode .controls {
            pointer-events: none;
        }

        body.gun-mode .control-btn {
            pointer-events: auto;
        }

        .control-btn {
            width: 80px;
            height: 80px;
            border: none !important;
            background: none !important;
            background-color: transparent !important;
            cursor: pointer;
            display: block;
            transition: all 0.3s ease;
            background-size: 70px 70px !important;
            background-repeat: no-repeat !important;
            background-position: center !important;
            outline: none !important;
            box-shadow: none !important;
        }

        .control-btn:hover {
            transform: scale(1.1);
            background-color: transparent !important;
        }

        .control-btn:focus {
            outline: none !important;
            background-color: transparent !important;
        }

        .control-btn:active {
            background-color: transparent !important;
        }

        .control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .control-btn.active {
            background: #FFD700;
            border-color: #FFB000;
            transform: scale(1.1);
        }

        .balloon-mode {
            cursor: url('images/balloon1.png') 16 54, auto;
        }

        .balloon-btn {
            background-image: url('images/balloon1.png');
        }

        .gun-btn {
            background-image: url('images/gun.png') !important;
            background-color: transparent !important;
            background-size: 85px 85px !important;
        }

        .gun-btn:hover {
            transform: scale(1.1);
            background-color: transparent !important;
        }

        .gun-btn.active {
            transform: scale(1.2);
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.8)) drop-shadow(0 0 25px rgba(255, 255, 255, 0.6));
            background-color: transparent !important;
        }

        .gun-btn:focus, .gun-btn:active {
            background-color: transparent !important;
        }

        .normal-btn {
            background-image: url('images/cursor.png') !important;
            background-color: transparent !important;
            background-size: 50px 50px !important;
        }

        .normal-btn:hover {
            transform: scale(1.1);
            background-color: transparent !important;
        }

        .normal-btn.active {
            transform: scale(1.2);
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.8)) drop-shadow(0 0 25px rgba(255, 255, 255, 0.6));
            background-color: transparent !important;
        }

        .normal-btn:focus, .normal-btn:active {
            background-color: transparent !important;
        }

        .gun-mode {
            cursor: url('images/scope.png') 16 46, crosshair;
        }

        .balloon {
            position: absolute;
            opacity: 0.9;
            animation: float-up 15s linear forwards;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
            /* More precise hit detection */
            border-radius: 50%;
        }

        @keyframes float-up {
            0% {
                transform: translateY(0px);
                opacity: 0.9;
            }
            100% {
                transform: translateY(-150vh);
                opacity: 0.9;
            }
        }

        .pop-effect {
            position: absolute;
            pointer-events: none;
            font-size: 2rem;
            color: #FF6B6B;
            font-weight: bold;
            animation: pop-animation 0.8s ease-out forwards;
            z-index: 1500;
        }

        @keyframes pop-animation {
            0% {
                opacity: 1;
                transform: scale(0.5);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                opacity: 0;
                transform: scale(1.5);
            }
        }

        /* Explosion Effect Styles */
        .explosion {
            position: absolute;
            pointer-events: none;
            z-index: 1400;
        }

        .explosion-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: explode 0.6s ease-out forwards;
        }

        .explosion-particle.large {
            width: 12px;
            height: 12px;
        }

        .explosion-particle.small {
            width: 5px;
            height: 5px;
        }

        @keyframes explode {
            0% {
                opacity: 1;
                transform: scale(1) translate(0, 0);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2) translate(var(--dx), var(--dy));
            }
            100% {
                opacity: 0;
                transform: scale(0.5) translate(calc(var(--dx) * 2), calc(var(--dy) * 2));
            }
        }

        /* Ring explosion effect */
        .explosion-ring {
            position: absolute;
            border: 3px solid;
            border-radius: 50%;
            animation: ring-expand 0.5s ease-out forwards;
            opacity: 0.8;
        }

        @keyframes ring-expand {
            0% {
                width: 10px;
                height: 10px;
                opacity: 0.8;
                transform: translate(-50%, -50%);
            }
            100% {
                width: 80px;
                height: 80px;
                opacity: 0;
                transform: translate(-50%, -50%);
            }
        }

        .clouds {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .cloud {
            position: absolute;
            animation: drift 20s linear infinite;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* Cloud type 2 (original) */
        .cloud1 {
            width: 180px;
            height: 100px;
            top: 15%;
            animation-duration: 35s;
            background-image: url('images/cloud2.png');
        }

        .cloud2 {
            width: 180px;
            height: 100px;
            top: 10%;
            animation-duration: 30s;
            animation-delay: -10s;
            background-image: url('images/cloud2.png');
        }

        .cloud5 {
            width: 200px;
            height: 110px;
            top: 35%;
            animation-duration: 28s;
            animation-delay: -5s;
            background-image: url('images/cloud2.png');
        }

        .cloud8 {
            width: 190px;
            height: 105px;
            top: 55%;
            animation-duration: 33s;
            animation-delay: -12s;
            background-image: url('images/cloud2.png');
        }

        /* Cloud type 3 (new) */
        .cloud3 {
            width: 160px;
            height: 90px;
            top: 25%;
            animation-duration: 40s;
            animation-delay: -20s;
            background-image: url('images/cloud3.png');
        }

        .cloud6 {
            width: 150px;
            height: 85px;
            top: 45%;
            animation-duration: 38s;
            animation-delay: -25s;
            background-image: url('images/cloud3.png');
        }

        /* Cloud type 4 (new) */
        .cloud4 {
            width: 160px;
            height: 90px;
            top: 5%;
            animation-duration: 45s;
            animation-delay: -15s;
            background-image: url('images/cloud4.png');
        }

        .cloud7 {
            width: 170px;
            height: 95px;
            top: 8%;
            animation-duration: 42s;
            animation-delay: -18s;
            background-image: url('images/cloud4.png');
        }

        @keyframes drift {
            0% {
                transform: translateX(-200px);
            }
            100% {
                transform: translateX(calc(100vw + 200px));
            }
        }

        /* Stars */
        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 2s ease-in-out infinite alternate;
        }

        .star.small {
            width: 2px;
            height: 2px;
        }

        .star.medium {
            width: 3px;
            height: 3px;
        }

        .star.large {
            width: 4px;
            height: 4px;
        }

        @keyframes twinkle {
            0% {
                opacity: 0.3;
                transform: scale(1);
            }
            100% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        .nav-buttons {
            position: fixed;
            top: 30px;
            left: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            pointer-events: none;
        }

        .nav-buttons.clickable {
            pointer-events: auto;
        }

        /* Make nav buttons clickthrough in gun mode unless they're clickable */
        body.gun-mode .nav-buttons:not(.clickable) {
            pointer-events: none;
        }

        body.gun-mode .nav-buttons.clickable {
            pointer-events: none;
        }

        body.gun-mode .nav-buttons.clickable .nav-btn {
            pointer-events: auto;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #fff;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #4A90E2;
            font-weight: bold;
            font-size: 0.75rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            white-space: nowrap;
            height: 32px;
        }

        .nav-buttons:not(.clickable) .nav-btn {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .nav-btn:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .nav-btn-icon {
            width: 22px;
            height: 22px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            flex-shrink: 0;
        }

        /* Button text positioning */
        .nav-btn span {
            margin-left: -11px;
        }

         .nav-btn1 span {
            margin-left: -6px;
        }

        /* DEX text specific positioning */
        .nav-btn2 span {
            margin-left: -8px;
        }

        /* Community text specific positioning */
        .nav-btn3 span {
            margin-left: -4px;
        }

        /* DEX text specific positioning */
        .nav-btn4 span {
            margin-left: -6px;
        }

        /* Individual button width adjustments */
        .nav-btn1 {
            width: 90px;
        }

        .nav-btn2 {
            width: 105px;
        }

        .nav-btn3 {
            width: 100px;
        }

        .nav-btn4 {
            width: 80px;
        }

        /* Icon specific positioning and sizing */
        .nav-btn1 .nav-btn-icon { 
            background-image: url('images/pump.png');
            margin-left: -5px;
        }

        .nav-btn2 .nav-btn-icon { 
            background-image: url('images/dex.png');
            margin-left: -1px;
            width: 26px;
            height: 26px;
        }

        .nav-btn3 .nav-btn-icon { 
            background-image: url('images/x.png');
            margin-left: -3px;
        }
        
        .nav-btn4 .nav-btn-icon { 
            background-image: url('images/copy.png'); 
             margin-left: -3px;
        }

        .score {
            position: fixed;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #4A90E2;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 8px;
            text-align: center;
        }

        .score-item {
            display: block;
        }

        .missed-counter {
            color: #FF6B6B;
            font-size: 1rem;
        }

        /* Make score clickthrough in gun mode */
        body.gun-mode .score {
            pointer-events: none;
        }

        /* Copy notification styles */
        .copy-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .copy-notification.show {
            opacity: 1;
        }


    </style>
</head>
<body>
    <div class="nav-buttons">
        <a href="https://pump.fun/board" class="nav-btn nav-btn1" target="_blank">
            <div class="nav-btn-icon"></div>
            <span>Pump fun</span>
        </a>
        <a href="https://dexscreener.com" class="nav-btn nav-btn2" target="_blank">
            <div class="nav-btn-icon"></div>
            <span>Dexscreener</span>
        </a>
        <a href="https://x.com/i/communities/1958853342311936122" class="nav-btn nav-btn3" target="_blank">
            <div class="nav-btn-icon"></div>
            <span>Community</span>
        </a>
        <div class="nav-btn nav-btn4" id="copyBtn">
            <div class="nav-btn-icon"></div>
            <span>Copy CA</span>
        </div>
    </div>

    <div class="copy-notification" id="copyNotification">
        Text copied to clipboard!
    </div>



    <div class="stars" id="stars">
        <!-- Stars will be generated by JavaScript -->
    </div>

    <div class="clouds">
        <!-- Cloud type 2 (original) -->
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
        <div class="cloud cloud5"></div>
        <div class="cloud cloud8"></div>
        
        <!-- Cloud type 3 (new) -->
        <div class="cloud cloud3"></div>
        <div class="cloud cloud6"></div>
        
        <!-- Cloud type 4 (new) -->
        <div class="cloud cloud4"></div>
        <div class="cloud cloud7"></div>
    </div>

    <div class="header">
        <h1 class="title">BALLOON</h1>
        <p class="subtitle">This will fly forever</p>
        <div class="main-icon"></div>
    </div>

    <div class="controls">
        <div class="control-btn normal-btn active" title="Normal Mode"></div>
        <div class="control-btn gun-btn" title="Pop Balloons"></div>
    </div>

    <div class="score">
        <div class="score-item">Popped: <span id="score">0</span></div>
        <div class="score-item missed-counter">Missed: <span id="missed">0</span></div>
    </div>

    <script>
        let currentMode = 'balloon';
        let balloons = [];
        let score = 0;
        let missedCount = 0;
        let balloonIdCounter = 0;

        // Day-night cycle variables
        let dayNightStartTime = Date.now();
        const CYCLE_DURATION = 180000; // 3 minutes total cycle (slower transitions)
        
        const normalBtn = document.querySelector('.normal-btn');
        const gunBtn = document.querySelector('.gun-btn');
        const scoreDisplay = document.getElementById('score');
        const missedDisplay = document.getElementById('missed');
        const body = document.body;
        const copyBtn = document.getElementById('copyBtn');
        const copyNotification = document.getElementById('copyNotification');
        const starsContainer = document.getElementById('stars');

        const balloonImages = ['images/balloon1.png', 'images/balloon2.png', 'images/balloon3.png', 'images/balloon4.png'];

        // Generate stars
        function generateStars() {
            const starCount = 100;
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // Random size
                const sizes = ['small', 'medium', 'large'];
                const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
                star.classList.add(randomSize);
                
                // Random position
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                
                // Random animation delay for twinkling effect
                star.style.animationDelay = Math.random() * 2 + 's';
                
                starsContainer.appendChild(star);
            }
        }

        // Initialize stars
        generateStars();

        // Day-night cycle function with ultra-smooth transitions (starting from day)
        function updateDayNightCycle() {
            const currentTime = Date.now();
            const elapsed = currentTime - dayNightStartTime;
            const cycleProgress = (elapsed % CYCLE_DURATION) / CYCLE_DURATION;
            
            // Define many intermediate phases starting from day
            let bgColor1, bgColor2, bgColor3, bgColor4;
            let cloudsOpacity, starsOpacity;
            
            if (cycleProgress < 0.1) { // Day (0-10%)
                bgColor1 = '#87CEEB';
                bgColor2 = '#E0F6FF';
                bgColor3 = '#E0F6FF';
                bgColor4 = '#87CEFA';
                cloudsOpacity = 1;
                starsOpacity = 0;
            } else if (cycleProgress < 0.2) { // Late Afternoon (10-20%)
                const t = (cycleProgress - 0.1) / 0.1;
                bgColor1 = interpolateColor('#87CEEB', '#F4A460', t);
                bgColor2 = interpolateColor('#E0F6FF', '#DDA0DD', t);
                bgColor3 = interpolateColor('#E0F6FF', '#FFB6C1', t);
                bgColor4 = interpolateColor('#87CEFA', '#FFA07A', t);
                cloudsOpacity = 1;
                starsOpacity = 0;
            } else if (cycleProgress < 0.25) { // Early Evening (20-25%)
                const t = (cycleProgress - 0.2) / 0.05;
                bgColor1 = interpolateColor('#F4A460', '#FF7F50', t);
                bgColor2 = interpolateColor('#DDA0DD', '#FF6347', t);
                bgColor3 = interpolateColor('#FFB6C1', '#FF69B4', t);
                bgColor4 = interpolateColor('#FFA07A', '#FF4500', t);
                cloudsOpacity = 1 - (t * 0.2);
                starsOpacity = t * 0.1;
            } else if (cycleProgress < 0.3) { // Sunset (25-30%)
                const t = (cycleProgress - 0.25) / 0.05;
                bgColor1 = interpolateColor('#FF7F50', '#FF6B6B', t);
                bgColor2 = interpolateColor('#FF6347', '#FF8E53', t);
                bgColor3 = interpolateColor('#FF69B4', '#4A90E2', t);
                bgColor4 = interpolateColor('#FF4500', '#2C5F8A', t);
                cloudsOpacity = 0.8 - (t * 0.3);
                starsOpacity = 0.1 + (t * 0.2);
            } else if (cycleProgress < 0.35) { // Dusk (30-35%)
                const t = (cycleProgress - 0.3) / 0.05;
                bgColor1 = interpolateColor('#FF6B6B', '#483D8B', t);
                bgColor2 = interpolateColor('#FF8E53', '#2F4F4F', t);
                bgColor3 = interpolateColor('#4A90E2', '#191970', t);
                bgColor4 = interpolateColor('#2C5F8A', '#000080', t);
                cloudsOpacity = 0.5 - (t * 0.2);
                starsOpacity = 0.3 + (t * 0.3);
            } else if (cycleProgress < 0.4) { // Early Night (35-40%)
                const t = (cycleProgress - 0.35) / 0.05;
                bgColor1 = interpolateColor('#483D8B', '#2C2C54', t);
                bgColor2 = interpolateColor('#2F4F4F', '#1A1A2E', t);
                bgColor3 = interpolateColor('#191970', '#16213E', t);
                bgColor4 = interpolateColor('#000080', '#0F3460', t);
                cloudsOpacity = 0.3 - (t * 0.2);
                starsOpacity = 0.6 + (t * 0.2);
            } else if (cycleProgress < 0.45) { // Deep Night (40-45%)
                const t = (cycleProgress - 0.4) / 0.05;
                bgColor1 = interpolateColor('#2C2C54', '#0B1426', t);
                bgColor2 = interpolateColor('#1A1A2E', '#1A1A2E', t);
                bgColor3 = interpolateColor('#16213E', '#16213E', t);
                bgColor4 = interpolateColor('#0F3460', '#0F3460', t);
                cloudsOpacity = 0.1 - (t * 0.1);
                starsOpacity = 0.8 + (t * 0.15);
            } else if (cycleProgress < 0.55) { // Midnight (45-55%)
                const t = (cycleProgress - 0.45) / 0.1;
                bgColor1 = interpolateColor('#0B1426', '#000000', t);
                bgColor2 = interpolateColor('#1A1A2E', '#0F0F23', t);
                bgColor3 = interpolateColor('#16213E', '#1A1A2E', t);
                bgColor4 = interpolateColor('#0F3460', '#1A1A2E', t);
                cloudsOpacity = 0;
                starsOpacity = 0.95 + (t * 0.05);
            } else if (cycleProgress < 0.65) { // Late Night (55-65%)
                const t = (cycleProgress - 0.55) / 0.1;
                bgColor1 = interpolateColor('#000000', '#000000', t);
                bgColor2 = interpolateColor('#0F0F23', '#0F0F23', t);
                bgColor3 = interpolateColor('#1A1A2E', '#1A1A2E', t);
                bgColor4 = interpolateColor('#1A1A2E', '#1A1A2E', t);
                cloudsOpacity = 0;
                starsOpacity = 1;
            } else if (cycleProgress < 0.7) { // Early Dawn (65-70%)
                const t = (cycleProgress - 0.65) / 0.05;
                bgColor1 = interpolateColor('#000000', '#1A1A2E', t);
                bgColor2 = interpolateColor('#0F0F23', '#2C2C54', t);
                bgColor3 = interpolateColor('#1A1A2E', '#40407A', t);
                bgColor4 = interpolateColor('#1A1A2E', '#2C2C54', t);
                cloudsOpacity = t * 0.2;
                starsOpacity = 1 - (t * 0.3);
            } else if (cycleProgress < 0.75) { // Pre-Dawn (70-75%)
                const t = (cycleProgress - 0.7) / 0.05;
                bgColor1 = interpolateColor('#1A1A2E', '#2C3E50', t);
                bgColor2 = interpolateColor('#2C2C54', '#34495E', t);
                bgColor3 = interpolateColor('#40407A', '#5D6D7E', t);
                bgColor4 = interpolateColor('#2C2C54', '#34495E', t);
                cloudsOpacity = 0.2 + (t * 0.2);
                starsOpacity = 0.7 - (t * 0.3);
            } else if (cycleProgress < 0.8) { // Dawn (75-80%)
                const t = (cycleProgress - 0.75) / 0.05;
                bgColor1 = interpolateColor('#2C3E50', '#8B4513', t);
                bgColor2 = interpolateColor('#34495E', '#CD853F', t);
                bgColor3 = interpolateColor('#5D6D7E', '#DEB887', t);
                bgColor4 = interpolateColor('#34495E', '#B8860B', t);
                cloudsOpacity = 0.4 + (t * 0.3);
                starsOpacity = 0.4 - (t * 0.4);
            } else if (cycleProgress < 0.85) { // Sunrise (80-85%)
                const t = (cycleProgress - 0.8) / 0.05;
                bgColor1 = interpolateColor('#8B4513', '#FFB347', t);
                bgColor2 = interpolateColor('#CD853F', '#FFA500', t);
                bgColor3 = interpolateColor('#DEB887', '#FFE4B5', t);
                bgColor4 = interpolateColor('#B8860B', '#DAA520', t);
                cloudsOpacity = 0.7 + (t * 0.2);
                starsOpacity = t > 0.5 ? 0 : 0.1 - (t * 0.2);
            } else if (cycleProgress < 0.95) { // Early Morning (85-95%)
                const t = (cycleProgress - 0.85) / 0.1;
                bgColor1 = interpolateColor('#FFB347', '#87CEEB', t);
                bgColor2 = interpolateColor('#FFA500', '#B0E0E6', t);
                bgColor3 = interpolateColor('#FFE4B5', '#E0F6FF', t);
                bgColor4 = interpolateColor('#DAA520', '#87CEFA', t);
                cloudsOpacity = 0.9 + (t * 0.1);
                starsOpacity = 0;
            } else { // Mid Morning (95-100%)
                const t = (cycleProgress - 0.95) / 0.05;
                bgColor1 = interpolateColor('#87CEEB', '#87CEEB', t);
                bgColor2 = interpolateColor('#B0E0E6', '#E0F6FF', t);
                bgColor3 = interpolateColor('#E0F6FF', '#E0F6FF', t);
                bgColor4 = interpolateColor('#87CEFA', '#87CEFA', t);
                cloudsOpacity = 1;
                starsOpacity = 0;
            }
            
            // Apply smooth background
            body.style.background = `linear-gradient(135deg, ${bgColor1} 0%, ${bgColor2} 30%, ${bgColor3} 50%, ${bgColor4} 100%)`;
            
            // Apply smooth opacity changes
            document.querySelector('.clouds').style.opacity = cloudsOpacity;
            starsContainer.style.opacity = starsOpacity;
        }
        
        // Color interpolation helper function
        function interpolateColor(color1, color2, t) {
            const r1 = parseInt(color1.slice(1, 3), 16);
            const g1 = parseInt(color1.slice(3, 5), 16);
            const b1 = parseInt(color1.slice(5, 7), 16);
            
            const r2 = parseInt(color2.slice(1, 3), 16);
            const g2 = parseInt(color2.slice(3, 5), 16);
            const b2 = parseInt(color2.slice(5, 7), 16);
            
            const r = Math.round(r1 + (r2 - r1) * t);
            const g = Math.round(g1 + (g2 - g1) * t);
            const b = Math.round(b1 + (b2 - b1) * t);
            
            return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
        }

        // Start the day-night cycle
        updateDayNightCycle();
        setInterval(updateDayNightCycle, 1000); // Update every second

        // Explosion effect function
        function createExplosion(x, y, color) {
            const explosion = document.createElement('div');
            explosion.className = 'explosion';
            explosion.style.left = x + 'px';
            explosion.style.top = y + 'px';
            
            // Create ring effect
            const ring = document.createElement('div');
            ring.className = 'explosion-ring';
            ring.style.borderColor = color;
            ring.style.left = '0px';
            ring.style.top = '0px';
            explosion.appendChild(ring);
            
            // Create particles
            const particleCount = 12;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'explosion-particle';
                
                // Random particle size
                const sizes = ['small', '', 'large'];
                const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
                if (randomSize) particle.classList.add(randomSize);
                
                // Set particle color
                particle.style.backgroundColor = color;
                
                // Calculate random direction
                const angle = (i / particleCount) * 2 * Math.PI + (Math.random() - 0.5) * 0.5;
                const distance = 40 + Math.random() * 20; // Random distance between 40-60px
                
                const dx = Math.cos(angle) * distance;
                const dy = Math.sin(angle) * distance;
                
                particle.style.setProperty('--dx', dx + 'px');
                particle.style.setProperty('--dy', dy + 'px');
                
                // Random animation delay for more organic feel
                particle.style.animationDelay = Math.random() * 0.1 + 's';
                
                explosion.appendChild(particle);
            }
            
            document.body.appendChild(explosion);
            
            // Remove explosion after animation
            setTimeout(() => {
                if (explosion.parentNode) {
                    explosion.remove();
                }
            }, 600);
        }

        // Copy function for button 4
        copyBtn.addEventListener('click', async (event) => {
            event.preventDefault();
            event.stopPropagation();
            
            try {
                await navigator.clipboard.writeText('coming soon');
                
                // Show notification
                copyNotification.classList.add('show');
                
                // Hide notification after 2 seconds
                setTimeout(() => {
                    copyNotification.classList.remove('show');
                }, 2000);
                
            } catch (err) {
                // Fallback for browsers that don't support clipboard API
                console.error('Failed to copy text: ', err);
                
                // Create a temporary textarea element
                const textArea = document.createElement('textarea');
                textArea.value = 'coming soon';
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                // Show notification
                copyNotification.classList.add('show');
                setTimeout(() => {
                    copyNotification.classList.remove('show');
                }, 2000);
            }
        });

        // Mode switching
        normalBtn.addEventListener('click', () => {
            currentMode = 'balloon';
            normalBtn.classList.add('active');
            gunBtn.classList.remove('active');
            body.classList.remove('gun-mode');
            body.classList.add('balloon-mode');
            
            // Enable nav buttons
            document.querySelector('.nav-buttons').classList.add('clickable');
        });

        gunBtn.addEventListener('click', () => {
            currentMode = 'gun';
            gunBtn.classList.add('active');
            normalBtn.classList.remove('active');
            body.classList.remove('balloon-mode');
            body.classList.add('gun-mode');
            
            // Disable nav buttons
            document.querySelector('.nav-buttons').classList.remove('clickable');
        });

        // Initialize with balloon mode
        body.classList.add('balloon-mode');
        document.querySelector('.nav-buttons').classList.add('clickable');

        // Create balloon function
        function createBalloon(x, y) {
            const balloon = document.createElement('div');
            balloon.className = 'balloon';
            balloon.id = 'balloon-' + balloonIdCounter++;
            
            const randomImage = balloonImages[Math.floor(Math.random() * balloonImages.length)];
            balloon.style.backgroundImage = `url('${randomImage}')`;
            balloon.dataset.balloonType = randomImage; // Store balloon type for color reference
            balloon.dataset.counted = 'false'; // Track if balloon has been counted as missed
            
            // Randomize balloon size (50% to 150% of original size)
            const sizeMultiplier = 0.5 + Math.random() * 1.0; // 0.5 to 1.5
            const balloonWidth = 180 * sizeMultiplier;
            const balloonHeight = 240 * sizeMultiplier;
            balloon.style.width = balloonWidth + 'px';
            balloon.style.height = balloonHeight + 'px';
            
            balloon.style.left = x - (balloonWidth / 2) + 'px';
            balloon.style.bottom = '-300px'; // Start much lower off-screen
            
            // Add slight random horizontal drift
            const drift = (Math.random() - 0.5) * 100;
            balloon.style.setProperty('--drift', drift + 'px');
            
            document.body.appendChild(balloon);
            balloons.push(balloon);

            // Set up intersection observer for missed balloon counting
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    // Check if balloon is crossing the virtual line at the top
                    const balloonRect = entry.boundingClientRect;
                    if (balloonRect.bottom <= 50 && balloon.dataset.counted === 'false') { // Virtual line at 50px from top
                        balloon.dataset.counted = 'true';
                        missedCount++;
                        missedDisplay.textContent = missedCount;
                        observer.unobserve(balloon); // Stop observing this balloon
                    }
                });
            }, {
                threshold: 0,
                rootMargin: '0px'
            });

            observer.observe(balloon);

            // Remove balloon after animation completes naturally
            balloon.addEventListener('animationend', () => {
                if (balloon.parentNode) {
                    balloon.remove();
                    balloons = balloons.filter(b => b !== balloon);
                    observer.unobserve(balloon);
                }
            });

            // More generous fallback removal
            setTimeout(() => {
                if (balloon.parentNode) {
                    balloon.remove();
                    balloons = balloons.filter(b => b !== balloon);
                    observer.unobserve(balloon);
                }
            }, 18000); // Much longer safety buffer

            return balloon;
        }

        // Improved balloon hit detection
        function getBalloonAtPoint(x, y) {
            // Get all elements at the click point
            const elementsAtPoint = document.elementsFromPoint(x, y);
            
            // Find the first balloon in the list
            for (let element of elementsAtPoint) {
                if (element.classList.contains('balloon')) {
                    // Check if click is within the balloon's circular shape
                    const rect = element.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    const radius = Math.min(rect.width, rect.height) / 2 * 0.8; // 80% of radius for more precise detection
                    
                    const distance = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));
                    
                    if (distance <= radius) {
                        return element;
                    }
                }
            }
            return null;
        }

        // Pop balloon function
        function popBalloon(balloon, event) {
            if (!balloon.parentNode) return;
            
            // Mark balloon as counted so it doesn't count as missed
            balloon.dataset.counted = 'true';
            
            // Get balloon center for explosion position
            const rect = balloon.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // Get balloon type for color
            const balloonType = balloon.dataset.balloonType;
            let color;
            
            if (balloonType.includes('balloon1.png')) {
                color = '#FF0000'; // Red
            } else if (balloonType.includes('balloon2.png')) {
                color = '#00FF00'; // Green
            } else if (balloonType.includes('balloon3.png')) {
                color = '#0000FF'; // Blue
            } else if (balloonType.includes('balloon4.png')) {
                color = '#FFFF00'; // Yellow
            } else {
                color = '#FF6B6B'; // Default red if something goes wrong
            }
            
            // Create explosion effect
            createExplosion(centerX, centerY, color);
            
            // Generate random multiplier between 0.1x and 1000x
            const multiplier = 0.1 + Math.random() * 999.9; // 0.1 to 1000
            const multiplierText = multiplier.toFixed(1) + 'x';
            
            // Create pop effect with multiplier
            const popEffect = document.createElement('div');
            popEffect.className = 'pop-effect';
            popEffect.textContent = multiplierText;
            popEffect.style.left = event.clientX - 30 + 'px';
            popEffect.style.top = event.clientY - 20 + 'px';
            popEffect.style.color = color;
            
            // Size based on multiplier value
            if (multiplier >= 500) {
                popEffect.style.fontSize = '2.5rem';
                popEffect.style.fontWeight = 'bold';
            } else if (multiplier >= 100) {
                popEffect.style.fontSize = '2.2rem';
                popEffect.style.fontWeight = 'bold';
            } else if (multiplier >= 10) {
                popEffect.style.fontSize = '2rem';
            } else {
                popEffect.style.fontSize = '1.8rem';
            }
            
            document.body.appendChild(popEffect);

            // Remove pop effect
            setTimeout(() => {
                if (popEffect.parentNode) {
                    popEffect.remove();
                }
            }, 800);

            // Remove balloon
            balloon.remove();
            balloons = balloons.filter(b => b !== balloon);
            
            // Update score
            score++;
            scoreDisplay.textContent = score;
        }

        // Click handler
        document.addEventListener('click', (event) => {
            // Don't trigger on control buttons or nav buttons in normal mode
            if (currentMode === 'balloon' && (event.target.closest('.controls') || event.target.closest('.nav-buttons'))) {
                return;
            }

            // In gun mode, don't trigger on control buttons but allow clicks through other UI elements
            if (currentMode === 'gun' && event.target.closest('.control-btn')) {
                return;
            }

            if (currentMode === 'balloon') {
                createBalloon(event.clientX, event.clientY);
            } else if (currentMode === 'gun') {
                // Use improved balloon detection
                const clickedBalloon = getBalloonAtPoint(event.clientX, event.clientY);
                if (clickedBalloon) {
                    popBalloon(clickedBalloon, event);
                }
            }
        });

        // Auto-generate some balloons for demo
        setInterval(() => {
            if (Math.random() < 0.2) { // 20% chance every 100ms (reduced from 30%)
                const x = Math.random() * window.innerWidth;
                createBalloon(x, window.innerHeight);
            }
        }, 100);
    </script>
</body>
</html>